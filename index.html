<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Reactive App with Firebase</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/simple.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <script src="https://www.gstatic.com/firebasejs/3.1.0/firebase.js"></script>
    <script>
    // Initialize Firebase
    var config = {
        apiKey: "AIzaSyCreR9sDWYuKtVmbCbTAOKxVhpFabiKeFw",
        authDomain: "reactive-ui.firebaseapp.com",
        databaseURL: "https://reactive-ui.firebaseio.com",
        storageBucket: "reactive-ui.appspot.com",
    };
    firebase.initializeApp(config);
    var db = firebase.database();
    </script>

    <!-- Custom styles -->
    <style>
        section {
            text-align: left !important;
        }
        
        em {
            /*text-decoration: underline;*/
        }
        
        strong {
            color: #FF2C2D;
        }

        .reveal pre code {
            max-height: none;
            line-height: 1.4;
        }
    </style>
</head>

<body>

    <div class="reveal">

        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
            <section data-markdown>
                <script type="text/template">
                    # Building Reactive Applications
                    ## with **Firebase**
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## Case Study
                    ### Design a browser based chatroom app
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## A typical *Server/Client* problem
                    #### Browser (Client)
                     - join a room
                     - see historical messages
                     - send and recieve new messages

                    #### 

                    #### Server
                    - can handle user states
                    - send historical messages
                    - broadcast messages to all chatroom members
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## Design Decisions
                    ### Server side
                    - Database (message storage)
                      - CRUD operations
                      - Schema design
                    - Broadcast messages to clients in realtime
                        - Websocket server
                        - Notifies clients when DB changes

                    ### Client side
                    - MV* frameworks
                      - Render UI with the latest data model
                      - Data model is updated via data change event
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## In another perspective ...
                    ### A **Data-Driven** Application
                </script>
            </section>
            
            <section data-markdown>
                <script type="text/template">
                    ## **Sharing States** is the key
                    ### State management and propagation
                    - Server manages a global state and broadcast them to the clients
                    - Client renders the view based on the current server side state
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## Reactive Programming
                    - "In computing, reactive programming is a programming paradigm oriented around data flows and the propagation of change."
                        - https://en.wikipedia.org/wiki/Reactive_programming
                    - Play Framework, Akka
                    - [The introduction to Reactive Programming you've been missing](https://gist.github.com/staltz/868e7e9bc2a7b8c1f754)
                    - Observable
                      - Angular 2's http module
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ### Thinking the state/data/model as a 
                    ### **Shared Memory**
                    - All clients see the same data
                    - Whenever client/server updates the data, the changes automatically propagate to all connected subjects
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## A Need for Realtime Realtime Web Database
                    ### Presents a *huge* technical challange to solve realtime issues
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## Solutions in the Market
                    - PaaS
                      - [Firebase](https://firebase.google.com/)
                        - Aquired By Google
                      - [野狗](https://www.wilddog.com/)
                        - A Chinese startup
                      - [PubNub](https://www.pubnub.com/)
                      - [Pusher](https://pusher.com/)

                    - Open Source (DIY)
                      - [rethinkdb](rethinkdb.com)
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## Introduction to Firebase DB 
                    - A data point is abstracted as a [`Refrence`](https://firebase.google.com/docs/reference/js/firebase.database.Reference) object
                    - Identified with a unique URL
                      - e.g., `{domain}/abc/def` refers to `abc.def`

                    - The `Reference` interface provides `set`, `push`, `update` methods for manipulation
                    - And `on`/`once` event listeners to
                      - get notifications when data at the reference URL gets updated
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## Firebase Javascript API Demo
                    - This page is already pre-configured with the following
                    ```js
                    const config = {
                        apiKey: "AIzaSyCreR9sDWYuKtVmbCbTAOKxVhpFabiKeFw",
                        authDomain: "reactive-ui.firebaseapp.com",
                        databaseURL: "https://reactive-ui.firebaseio.com",
                        storageBucket: "reactive-ui.appspot.com",
                    };
                    // Connect to DB
                    firebase.initializeApp(config);
                    const db = firebase.database();
                    ```
                    - Play with data
                    ```js
                    // Write values
                    db.ref('foo').set({
                        key: '123'
                    });
                    // Listen to DB changes
                    db.ref('bar').on('value', (bar) => { 
                        console.log(`New bar value: ${JSON.stringify(bar.val())}`);
                    });
                    ```
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## One Step forward
                    ### Add an abstraction over the DB
                    - Data is automatically synchronized between local and remote
                    - We can now focus on data manipulation itself and how it can be rendered on the client side
                    - Just like two-way data-binding between server and client
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ### Supported Libraries
                    - [AngularFire](https://github.com/firebase/angularfire/blob/master/docs/quickstart.md)
                      - describes this as *Three-Way* data-binding
                      - "automatically synchronizes any changes to your DOM, your JavaScript, and the Firebase database"
                    - [Google Polymer](https://elements.polymer-project.org/elements/polymerfire?active=firebase-document)
                      - Web Component Based
                      - Will Demo Later
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## AngularFire Example

                    ```js
                    angular
                      .module("sampleApp", ["firebase"]);
                      .controller("SampleCtrl", ($scope, $firebaseObject) => {
                        const ref = firebase.database().ref().child("data");
                        
                        // Sync the data into a local object
                        const syncObject = $firebaseObject(ref);

                        // synchronize the object with a three-way data binding
                        syncObject.$bindTo($scope, "data");
                    });
                    ```
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## Polymer Demo
                    - Pure Data Driven Chatroom
                    - https://github.com/pengx17/nc_polymer
                </script>
            </section>

            <section style='width: 100%; height: 100%;'>
                <iframe style='width: 100%; height: 100%' src="https://xp-chat.firebaseapp.com/" frameborder="0"></iframe>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## What's more about Firebase
                    - A Google Product
                    - A nice console page
                    - Static Web Hosting
                    - Data Analytics
                    - User Authentication
                      - Permission control over data points
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    ## Ideas
                    - Building quick data-driven prototypes
                      - You don't need to worry about how the client can read the data, just put the data in the DB
                    - Online Games
                      - Use the realtime DB as a shared memory
                    - Realtime Notification / Alarms

                    ## For custom deployment
                    - See https://rethinkdb.com/docs/deployment-tools/
                      - AWS AMI
                      - Docker Images
                </script>
            </section>

            <section data-markdown>
                <script type="text/template">
                    # Thanks
                </script>
            </section>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>
    <script src="js/index.js"></script>
</body>
</html>